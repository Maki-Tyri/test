<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Family Tree App with Side Connections & Login</title>
<style>
  /* Reset */
  * {
    box-sizing: border-box;
  }
  body, html {
    margin: 0; padding: 0; height: 100%;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f4f8;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  /* ----------- LOGIN PAGE ----------- */
  #login-page {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    background: url('https://images.unsplash.com/photo-1503264116251-35a269479413?auto=format&fit=crop&w=800&q=80') no-repeat center/cover;
    padding: 20px;
  }
  #login-container {
    background: rgba(255 255 255 / 0.15);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-radius: 14px;
    padding: 40px 30px;
    width: 320px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.12);
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  #login-container h2 {
    margin-bottom: 24px;
    font-weight: 700;
    font-size: 1.8rem;
    letter-spacing: 1.2px;
  }
  #login-container input[type="text"],
  #login-container input[type="password"] {
    width: 100%;
    padding: 12px 15px;
    margin: 10px 0 20px;
    border-radius: 8px;
    border: none;
    font-size: 1rem;
    outline: none;
  }
  #login-container button {
    width: 100%;
    padding: 14px 0;
    background: #007bff;
    border: none;
    border-radius: 8px;
    font-weight: 700;
    color: white;
    font-size: 1.1rem;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  #login-container button:hover {
    background: #0056b3;
  }

  /* ----------- MAIN APP ----------- */
  #app {
    flex: 1;
    display: flex;
    min-height: 0; /* for flex children to shrink properly */
    overflow: hidden;
  }

  /* Side connections panel */
  #connections-panel {
    background: #ffffffdd;
    width: 180px;
    border-right: 2px solid #007bff;
    overflow-y: auto;
    padding: 10px 5px;
    font-size: 0.9rem;
    user-select: none;
    box-shadow: inset -3px 0 8px -3px rgba(0,123,255,0.3);
  }

  #connections-panel h3 {
    font-weight: 600;
    margin: 10px 0;
    color: #007bff;
    border-bottom: 1px solid #007bff;
    padding-bottom: 6px;
  }

  #connections-list {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  #connections-list li {
    margin: 8px 0;
    cursor: pointer;
    color: #004a99;
    transition: color 0.2s;
  }
  #connections-list li:hover {
    color: #007bff;
    text-decoration: underline;
  }

  /* Family tree container - flexible & scrollable */
  #family-tree-container {
    flex: 1;
    overflow: auto;
    padding: 20px;
    display: flex;
    justify-content: center;
  }

  /* The tree container that grows as members added */
  #tree-root {
    display: flex;
    flex-direction: column;
    gap: 40px;
    max-width: 100%;
    min-width: 300px;
  }

  /* Each person node */
  .tree-node {
    background: white;
    border-radius: 12px;
    box-shadow: 0 3px 8px rgb(0 0 0 / 0.12);
    padding: 12px 16px;
    min-width: 260px;
    max-width: 320px;
    user-select: none;
  }
  .tree-node.spouse-node {
    background: #e8f0fe;
    border: 1.5px solid #007bff;
  }

  .node-header {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 8px;
    margin-bottom: 10px;
  }
  .node-header input[type="text"] {
    flex-grow: 1;
    font-weight: 600;
    font-size: 1.1rem;
    border: none;
    border-bottom: 1.5px solid #007bff;
    padding: 4px 6px;
    outline-offset: 2px;
  }
  .node-header input[type="text"]:focus {
    background: #dbe9ff;
  }
  .node-header input[type="date"] {
    border-radius: 6px;
    border: 1px solid #aaa;
    padding: 4px 8px;
    font-size: 0.9rem;
  }
  .node-header input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }

  /* Buttons container */
  .node-buttons {
    display: flex;
    gap: 6px;
    flex-wrap: nowrap;
  }
  .node-buttons button {
    cursor: pointer;
    border-radius: 6px;
    border: none;
    background: #007bff;
    color: white;
    font-weight: 600;
    padding: 6px 10px;
    font-size: 0.85rem;
    transition: background 0.25s ease;
  }
  .node-buttons button:hover {
    background: #0056b3;
  }
  .node-buttons .delete-btn {
    background: #dc3545;
  }
  .node-buttons .delete-btn:hover {
    background: #a71d2a;
  }

  /* Spouses container - horizontal with gap */
  .spouses-container {
    display: flex;
    gap: 12px;
    margin-bottom: 8px;
    position: relative;
  }
  /* horizontal connecting line between spouses */
  .spouses-container::before {
    content: "";
    position: absolute;
    top: 20px;
    left: 0;
    right: 0;
    height: 2px;
    background-color: #007bff;
    z-index: 0;
    margin: auto;
    width: 80%;
    border-radius: 2px;
  }

  /* Children container vertical stack */
  .children-container {
    margin-left: 30px;
    border-left: 2px solid #007bff;
    padding-left: 20px;
    display: flex;
    flex-direction: column;
    gap: 30px;
  }

  /* Form for adding child or spouse */
  form.add-child-form,
  form.add-spouse-form {
    margin-top: 12px;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    background: #fefefe;
    padding: 12px;
    border-radius: 10px;
    box-shadow: 0 2px 6px rgb(0 0 0 / 0.1);
  }
  form.add-child-form input,
  form.add-spouse-form input {
    flex-grow: 1;
    padding: 6px 10px;
    font-size: 0.95rem;
    border-radius: 8px;
    border: 1px solid #ccc;
  }
  form.add-child-form input[type="checkbox"],
  form.add-spouse-form input[type="checkbox"] {
    flex-grow: 0;
    width: auto;
    margin-top: 6px;
  }
  form.add-child-form button,
  form.add-spouse-form button {
    background: #007bff;
    border: none;
    color: white;
    padding: 8px 12px;
    font-weight: 600;
    border-radius: 8px;
    cursor: pointer;
  }
  form.add-child-form button:hover,
  form.add-spouse-form button:hover {
    background: #0056b3;
  }

  /* SVG connectors */
  svg.connector-svg {
    position: absolute;
    top: 0; left: 0;
    pointer-events: none;
    overflow: visible;
  }

  /* Footer fixed with glass background */
  footer {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    padding: 14px 0;
    text-align: center;
    font-weight: 600;
    background: rgba(255 255 255 / 0.15);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    color: #007bff;
    box-shadow: 0 -2px 8px rgba(0, 123, 255, 0.15);
    user-select: none;
    z-index: 999;
  }

  /* Responsive tweaks */
  @media (max-width: 800px) {
    #connections-panel {
      width: 130px;
      font-size: 0.8rem;
      padding: 6px 4px;
    }
    #login-container {
      width: 90vw;
      padding: 30px 20px;
    }
    .tree-node {
      min-width: 220px;
      max-width: 280px;
      font-size: 0.9rem;
    }
    .node-header input[type="text"] {
      font-size: 1rem;
    }
    .node-header input[type="date"] {
      font-size: 0.8rem;
    }
  }
</style>
</head>
<body>

<!-- LOGIN PAGE -->
<div id="login-page">
  <div id="login-container">
    <h2>Login to Family Tree</h2>
    <input type="text" id="username" placeholder="Username" autocomplete="username" />
    <input type="password" id="password" placeholder="Password" autocomplete="current-password" />
    <button id="login-btn">Login</button>
  </div>
</div>

<!-- MAIN APP -->
<div id="app" style="display:none;">
  <nav id="connections-panel">
    <h3>Connections</h3>
    <ul id="connections-list"></ul>
  </nav>
  <main id="family-tree-container">
    <div id="tree-root"></div>
  </main>
</div>

<footer>&copy; 2025 Maki Web. All rights reserved</footer>

<script>
  // Dummy login: any non-empty username/password logs in
  const loginPage = document.getElementById('login-page');
  const app = document.getElementById('app');
  const loginBtn = document.getElementById('login-btn');
  loginBtn.addEventListener('click', () => {
    const user = document.getElementById('username').value.trim();
    const pass = document.getElementById('password').value.trim();
    if (!user || !pass) {
      alert('Enter username and password');
      return;
    }
    loginPage.style.display = 'none';
    app.style.display = 'flex';
    renderTree();
  });

  // Family data structure
  let familyIdCounter = 1;
  function createMember(name = '', dob = '', dod = '', isDeceased = false) {
    return {
      id: familyIdCounter++,
      name,
      dob,
      dod,
      isDeceased,
      spouses: [],
      children: []
    };
  }

  // Root person to start with
  let rootPerson = createMember('Root Person', '1980-01-01');

  // ========== DOM rendering ==========

  // Connections list
  const connectionsList = document.getElementById('connections-list');

  // Tree container
  const treeRoot = document.getElementById('tree-root');

  // Render entire tree
  function renderTree() {
    treeRoot.innerHTML = '';
    connectionsList.innerHTML = '';

    // Recursive render node with spouses and children
    function renderNode(person, parent=null) {
      const node = document.createElement('div');
      node.className = 'tree-node';
      node.dataset.id = person.id;

      // Header with name, dates, deceased checkbox
      const header = document.createElement('div');
      header.className = 'node-header';

      // Name input
      const nameInput = document.createElement('input');
      nameInput.type = 'text';
      nameInput.value = person.name;
      nameInput.placeholder = 'Full Name';
      nameInput.addEventListener('input', e => {
        person.name = e.target.value;
        updateConnectionsList();
      });
      header.appendChild(nameInput);

      // DOB input
      const dobInput = document.createElement('input');
      dobInput.type = 'date';
      dobInput.value = person.dob;
      dobInput.title = 'Date of Birth';
      dobInput.addEventListener('change', e => {
        person.dob = e.target.value;
      });
      header.appendChild(dobInput);

      // Died checkbox + Dod input if checked
      const diedLabel = document.createElement('label');
      diedLabel.style.marginLeft = '10px';
      diedLabel.style.userSelect = 'none';
      const diedCheckbox = document.createElement('input');
      diedCheckbox.type = 'checkbox';
      diedCheckbox.checked = person.isDeceased;
      diedCheckbox.title = 'Deceased';
      diedCheckbox.addEventListener('change', e => {
        person.isDeceased = e.target.checked;
        dodInput.disabled = !person.isDeceased;
        if (!person.isDeceased) {
          person.dod = '';
          dodInput.value = '';
        }
        renderTree();
      });
      diedLabel.appendChild(diedCheckbox);
      diedLabel.appendChild(document.createTextNode(' Died'));
      header.appendChild(diedLabel);

      const dodInput = document.createElement('input');
      dodInput.type = 'date';
      dodInput.value = person.dod;
      dodInput.title = 'Date of Death';
      dodInput.style.marginLeft = '8px';
      dodInput.disabled = !person.isDeceased;
      dodInput.addEventListener('change', e => {
        person.dod = e.target.value;
      });
      header.appendChild(dodInput);

      node.appendChild(header);

      // Buttons: add spouse, add child, delete (if not root)
      const btns = document.createElement('div');
      btns.className = 'node-buttons';

      const addSpouseBtn = document.createElement('button');
      addSpouseBtn.textContent = '+ Spouse';
      addSpouseBtn.title = 'Add spouse';
      addSpouseBtn.addEventListener('click', () => {
        const newSpouse = createMember();
        person.spouses.push(newSpouse);
        renderTree();
      });
      btns.appendChild(addSpouseBtn);

      const addChildBtn = document.createElement('button');
      addChildBtn.textContent = '+ Child';
      addChildBtn.title = 'Add child';
      addChildBtn.addEventListener('click', () => {
        const newChild = createMember();
        person.children.push(newChild);
        renderTree();
      });
      btns.appendChild(addChildBtn);

      if (parent !== null) {
        // Delete button (not root)
        const delBtn = document.createElement('button');
        delBtn.textContent = 'Delete';
        delBtn.className = 'delete-btn';
        delBtn.title = 'Delete this member';
        delBtn.addEventListener('click', () => {
          // Remove this person from parent's children or spouses
          let arr = parent.children.includes(person) ? parent.children : parent.spouses;
          const idx = arr.indexOf(person);
          if (idx !== -1) arr.splice(idx, 1);
          renderTree();
        });
        btns.appendChild(delBtn);
      }
      node.appendChild(btns);

      // Spouses horizontally, connected by line
      if (person.spouses.length) {
        const spousesContainer = document.createElement('div');
        spousesContainer.className = 'spouses-container';

        // The main person as spouse-node as well for alignment
        const mainSpouseNode = createSpouseNode(person);
        spousesContainer.appendChild(mainSpouseNode);

        person.spouses.forEach(spouse => {
          const spouseNode = createSpouseNode(spouse, person);
          spousesContainer.appendChild(spouseNode);
        });

        node.appendChild(spousesContainer);
      }

      // Children vertically, connected with vertical line
      if (person.children.length) {
        const childrenContainer = document.createElement('div');
        childrenContainer.className = 'children-container';

        person.children.forEach(child => {
          const childNode = renderNode(child, person);
          childrenContainer.appendChild(childNode);
        });

        node.appendChild(childrenContainer);
      }

      return node;
    }

    // Create spouse node for spouses container
    function createSpouseNode(person, parent=null) {
      const spouseNode = document.createElement('div');
      spouseNode.className = 'tree-node spouse-node';
      spouseNode.dataset.id = person.id;

      const header = document.createElement('div');
      header.className = 'node-header';

      const nameInput = document.createElement('input');
      nameInput.type = 'text';
      nameInput.value = person.name;
      nameInput.placeholder = 'Spouse Name';
      nameInput.addEventListener('input', e => {
        person.name = e.target.value;
        updateConnectionsList();
      });
      header.appendChild(nameInput);

      const dobInput = document.createElement('input');
      dobInput.type = 'date';
      dobInput.value = person.dob;
      dobInput.title = 'Date of Birth';
      dobInput.addEventListener('change', e => {
        person.dob = e.target.value;
      });
      header.appendChild(dobInput);

      const diedLabel = document.createElement('label');
      diedLabel.style.marginLeft = '10px';
      diedLabel.style.userSelect = 'none';
      const diedCheckbox = document.createElement('input');
      diedCheckbox.type = 'checkbox';
      diedCheckbox.checked = person.isDeceased;
      diedCheckbox.title = 'Deceased';
      diedCheckbox.addEventListener('change', e => {
        person.isDeceased = e.target.checked;
        dodInput.disabled = !person.isDeceased;
        if (!person.isDeceased) {
          person.dod = '';
          dodInput.value = '';
        }
        renderTree();
      });
      diedLabel.appendChild(diedCheckbox);
      diedLabel.appendChild(document.createTextNode(' Died'));
      header.appendChild(diedLabel);

      const dodInput = document.createElement('input');
      dodInput.type = 'date';
      dodInput.value = person.dod;
      dodInput.title = 'Date of Death';
      dodInput.style.marginLeft = '8px';
      dodInput.disabled = !person.isDeceased;
      dodInput.addEventListener('change', e => {
        person.dod = e.target.value;
      });
      header.appendChild(dodInput);

      spouseNode.appendChild(header);

      const btns = document.createElement('div');
      btns.className = 'node-buttons';

      const addChildBtn = document.createElement('button');
      addChildBtn.textContent = '+ Child';
      addChildBtn.title = 'Add child';
      addChildBtn.addEventListener('click', () => {
        const newChild = createMember();
        person.children.push(newChild);
        renderTree();
      });
      btns.appendChild(addChildBtn);

      if (parent !== null) {
        const delBtn = document.createElement('button');
        delBtn.textContent = 'Delete';
        delBtn.className = 'delete-btn';
        delBtn.title = 'Delete this spouse';
        delBtn.addEventListener('click', () => {
          let arr = parent.spouses;
          const idx = arr.indexOf(person);
          if (idx !== -1) arr.splice(idx, 1);
          renderTree();
        });
        btns.appendChild(delBtn);
      }
      spouseNode.appendChild(btns);

      return spouseNode;
    }

    // Update connections panel list with clickable links
    function updateConnectionsList() {
      connectionsList.innerHTML = '';

      function addToList(person, prefix='') {
        const li = document.createElement('li');
        li.textContent = `${prefix}${person.name || '(Unnamed)'}`;
        li.dataset.id = person.id;
        li.addEventListener('click', () => {
          scrollToNode(person.id);
        });
        connectionsList.appendChild(li);

        person.spouses.forEach(s => addToList(s, prefix + '  ♡ '));
        person.children.forEach(c => addToList(c, prefix + '  └─ '));
      }

      addToList(rootPerson);
    }

    // Scroll to node in tree
    function scrollToNode(id) {
      const el = treeRoot.querySelector(`[data-id='${id}']`);
      if (el) {
        el.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });
        el.style.outline = '3px solid #007bff';
        setTimeout(() => el.style.outline = 'none', 1600);
      }
    }

    // Append root person
    treeRoot.appendChild(renderNode(rootPerson));
    updateConnectionsList();
  }

</script>

</body>
</html>
