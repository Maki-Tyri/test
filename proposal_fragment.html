<!-- Keep your full version here -->
<!-- At the end of sayYes(), replace the redirect with postMessage: -->
<script>
  function sayYes() {
    setBackground('https://i.pinimg.com/736x/5a/9e/06/5a9e06ef555717d951d00b6403715b95.jpg');
    for (let i = 0; i < 50; i++) {
      const heart = document.createElement('div');
      heart.classList.add('heart');
      heart.style.left = Math.random() * window.innerWidth + 'px';
      heart.style.top = Math.random() * window.innerHeight + 'px';
      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), 1000);
    }
    for (let i = 0; i < 100; i++) {
      const sparkle = document.createElement('div');
      sparkle.classList.add('heart');
      sparkle.style.background = 'hotpink';
      sparkle.style.left = Math.random() * 100 + 'vw';
      sparkle.style.top = Math.random() * 100 + 'vh';
      document.body.appendChild(sparkle);
      setTimeout(() => sparkle.remove(), 1200);
    }

    let count = 3;
    const countdownEl = document.getElementById('countdown');
    const finalMessage = document.getElementById('finalMessage');
    countdownEl.style.display = 'block';
    countdownEl.innerText = count;

    const countdownInterval = setInterval(() => {
      count--;
      if (count > 0) {
        countdownEl.innerText = count;
      } else {
        clearInterval(countdownInterval);
        countdownEl.style.display = 'none';
        finalMessage.style.display = 'block';
        setTimeout(() => {
          window.parent.postMessage("goToSurprise", "*");
        }, 4000);
      }
    }, 1000);
  }
</script>
