<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: url('https://i.pinimg.com/736x/d7/00/04/d70004c89987ac91aef3f39d6f468655.jpg') no-repeat center center fixed;
    background-size: cover;
    height: 100vh;
    color: #fff;
    overflow: hidden;
    position: relative;
  }
  .overlay {
    padding: 20px;
    border-radius: 15px;
    text-align: center;
    width: 90%;
    max-width: 450px;
    margin: auto;
    margin-top: 20%;
    opacity: 1;
    position: relative;
  }
  #yesBtn, #noBtn {
    padding: 15px 25px;
    font-size: 20px;
    border-radius: 15px;
    border: none;
    cursor: pointer;
    margin: 15px;
  }
  #yesBtn {
    background-color: #ff69b4;
    color: white;
  }
  #noBtn {
    background-color: #bbb;
    color: black;
    position: absolute;
  }
</style>

<div class="overlay" id="proposalPage">
  <div id="proposal" style="font-size: 26px; margin-bottom: 20px;">
    I've loved you since I can't remember when,<br>
    and I'm gonna love you till I can't forget how.<br><br>
    <strong>Will you marry me?</strong>
  </div>
  <button id="yesBtn" onclick="sayYes()">Yes üíç</button>
  <button id="noBtn" onclick="shrinkNo()">No üôà</button>
</div>

<script>
  let noScale = 1;
  let noClicked = false;

  function shrinkNo() {
    const noBtn = document.getElementById("noBtn");
    const yesBtn = document.getElementById("yesBtn");

    if (!noClicked) {
      document.body.style.background = "url('https://i.pinimg.com/736x/04/ef/2c/04ef2cbeca3bc0548f5fae3f0558c494.jpg') no-repeat center center fixed";
      document.body.style.backgroundSize = "cover";
      noClicked = true;
    }

    if (noScale > 0.1) {
      noScale -= 0.05;
      noBtn.style.transform = `scale(${noScale})`;
    }

    const overlay = document.getElementById("proposalPage");
    const maxX = overlay.clientWidth - noBtn.offsetWidth;
    const maxY = overlay.clientHeight - noBtn.offsetHeight;
    const randX = Math.floor(Math.random() * maxX);
    const randY = Math.floor(Math.random() * maxY);
    noBtn.style.left = `${randX}px`;
    noBtn.style.top = `${randY}px`;

    yesBtn.style.transform = `scale(${1 + (1 - noScale)})`;

    if (noScale <= 0.1) {
      noBtn.style.display = "none";
    }
  }

  function sayYes() {
    document.body.style.background = "url('https://i.pinimg.com/736x/5a/9e/06/5a9e06ef555717d951d00b6403715b95.jpg') no-repeat center center fixed";
    document.body.style.backgroundSize = "cover";

    for (let i = 0; i < 50; i++) {
      const heart = document.createElement('div');
      heart.style.position = 'absolute';
      heart.style.width = '20px';
      heart.style.height = '20px';
      heart.style.background = 'red';
      heart.style.transform = 'rotate(45deg)';
      heart.style.left = Math.random() * window.innerWidth + 'px';
      heart.style.top = Math.random() * window.innerHeight + 'px';
      heart.style.borderRadius = '3px';
      heart.style.opacity = 0.8;
      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), 1000);
    }

    let count = 3;
    const countdownEl = document.createElement('div');
    countdownEl.style.position = 'fixed';
    countdownEl.style.top = '50%';
    countdownEl.style.left = '50%';
    countdownEl.style.transform = 'translate(-50%, -50%)';
    countdownEl.style.fontSize = '40px';
    countdownEl.style.fontWeight = 'bold';
    countdownEl.style.color = '#fff';
    document.body.appendChild(countdownEl);

    countdownEl.innerText = count;
    const interval = setInterval(() => {
      count--;
      if (count > 0) {
        countdownEl.innerText = count;
      } else {
        clearInterval(interval);
        countdownEl.remove();
        // Send message to parent to load surprise page
        window.parent.postMessage({ action: 'goToSurprise' }, '*');
      }
    }, 1000);
  }
</script>
